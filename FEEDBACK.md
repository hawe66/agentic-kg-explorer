- critic should recognize whether the retrieved data are insufficient to explain the query. → Phase 4
- ~~human intents are too narrow.~~ **DONE**: 11 intents from `config/intents.yaml`
  - lookup, exploration, path_trace, aggregation, comparison, recommendation
  - coverage_check, definition, update, expansion, out_of_scope
- ~~search planner is hard-coded.~~ **DONE**: YAML-driven templates
  - `config/cypher_templates.yaml` with 20+ templates
  - Entity type detection from patterns
  - Template selection by intent + entity types
- ~~'INTENT_CLASSIFICATION_PROMPT', '_extract_entities' doesn't have info over graphdb's entities. Cannot exactly extract entities.~~ **DONE**: Entity catalog system
  - `scripts/generate_entity_catalog.py` → `data/entity_catalog.json`
  - Intent classifier loads catalog dynamically
  - Alias mapping (CoT → m:cot)
  - Run: `poetry run python scripts/generate_entity_catalog.py`
- ~~i want embedding models to be abstract.~~ **DONE**: `src/retrieval/providers/` with YAML-driven router
  - `EmbeddingProvider` ABC in `base.py`
  - `OpenAIEmbeddingProvider` in `openai.py`
  - Router in `router.py` (uses `config/providers.yaml`)
  - Set `EMBEDDING_PROVIDER` and `EMBEDDING_MODEL` in `.env` to switch
- ~~ABSOLUTELY NONSENSE. MUST CHANGE THING.~~ **DONE**: Multi-dimensional confidence
  - ~~`Base confidence on graph result count`: _calculate_confidence at src/agents/nodes/synthesizer.py~~
  - NEW: 4-dimension weighted score (entity_match 0.3, intent_fulfillment 0.3, completeness 0.2, vector_similarity 0.2)
- ~~Graph visualization~~ **DONE**: `streamlit-agraph` integration in `src/ui/app.py`
  - Toggle in sidebar to show/hide graph
  - Node colors by type (Principle, Method, Implementation, Standard)
  - Overview mode: P→M→I structure
  - `fetch_kg_subgraph()` and `build_graph_from_results()` helpers